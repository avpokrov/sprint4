(()=>{"use strict";const t=class{constructor(t,e){this._config=t,this._validForm=document.querySelector(e),this._inputList=Array.from(this._validForm.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._validForm.querySelector(this._config.submitButtonSelector)}resetValidate(){this._inputList.forEach((t=>{this._hideInputError(t)})),this._toggleButtonState(this._inputList,this._buttonElement)}enableValidation(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._isValid(t),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}_isValid(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}_showInputError(t,e){this._validForm.querySelector(`.${t.id}-error`).textContent=e,t.classList.add("popup__input_type_error")}_hideInputError(t){this._validForm.querySelector(`.${t.id}-error`).textContent="",t.classList.remove("popup__input_type_error")}_toggleButtonState(t,e){this._hasInvalidInput(t)?this._disabledButton(e):this._enableButton(e)}_hasInvalidInput(t){return t.some((t=>!t.validity.valid))}_disabledButton(t){t.classList.add("popup__button-submit_disable"),t.setAttribute("disabled",!0)}_enableButton(t){t.classList.remove("popup__button-submit_disable"),t.removeAttribute("disabled")}},e=class{constructor(t){this._popup=document.querySelector(t)}open(){document.addEventListener("keydown",this._handleEscClose.bind(this)),this._popup.classList.add("popup__open")}close(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup__open")}setEventListeners(){this._popup.querySelector(".popup__close").addEventListener("click",(t=>{t.stopPropagation,this.close()})),this._popup.addEventListener("click",(t=>{t.target.classList.contains("popup")&&this.close()}))}_handleEscClose(t){"Escape"===t.key&&this.close()}},s=class extends e{constructor({popupSelector:t,submitForm:e}){super(t),this._form=this._popup.querySelector(".popup__form"),this._inputs=this._popup.querySelectorAll(".popup__input"),this._submitForm=e}_getInputValues(){return this._inputValues={},this._inputs.forEach((t=>{this._inputValues[t.name]=t.value})),this._inputValues}setInputValues({name:t,info:e}){this._inputs[0].value=t,this._inputs[1].value=e}setEventListeners(){this._form.addEventListener("submit",(t=>{t.preventDefault(),this._submitForm(this._getInputValues()),this.close()})),super.setEventListeners()}close(){this._form.reset(),super.close()}},r=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button"),o={popupEditProfile:".popup_profile_edit",popupImageCard:".popup_card-img",formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-submit",inactiveButtonClass:"popup__button-submit_disable",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},n=new class{constructor(t){this._url=t.url,this._headers=t.headers}getAllCard(){return fetch(`${this._url}/cards`,{headers:this._headers}).then((t=>t.json()))}getUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then((t=>t.json()))}}({url:"https://mesto.nomoreparties.co/v1/cohort-51",headers:{authorization:"6e94b493-b513-4271-a5ab-96db09cdfced","Content-Type":"application/json"}}),a=new class{constructor({userInfo:t,info:e}){this._htmlUserInfo=document.querySelector(t),this._htmlInfo=document.querySelector(e)}getUserInfo(){return{name:this._htmlUserInfo.textContent,info:this._htmlInfo.textContent}}setUserInfo({name:t,info:e}){this._htmlUserInfo.textContent=t,this._htmlInfo.textContent=e}}({userInfo:".profile__title",info:".profile__subtitle"}),p=(t,e)=>{_.open(t,e)};function u(t){return new class{constructor({dataElement:t,template:e,clickOnCard:s}){this._name=t.name,this._url=t.link,this._cardTemplate=e,this._clickOnCard=s}_getTemplate(){return document.querySelector(this._cardTemplate).content.children[0].cloneNode(!0)}_addEvent(){this._card.querySelector(".button-like").addEventListener("click",(t=>{this._addLike(t)})),this._card.querySelector(".card__button-del").addEventListener("click",(t=>{this._delCard()})),this._card.querySelector(".card__img").addEventListener("click",(t=>{this._clickOnCard(this._name,this._url)}))}_addLike(t){t.target.classList.toggle("buttton-like_active")}_delCard(){this._card.remove()}render(){return this._card=this._getTemplate(),this._card.querySelector(".card__img").src=this._url,this._card.querySelector(".card__title").textContent=this._name,this._addEvent(),this._card}}({dataElement:t,template:"#card",clickOnCard:p}).render()}const l=new s({popupSelector:".popup_profile_edit",submitForm:t=>{a.setUserInfo({name:t.nameProfile,info:t.infoProfile})}});l.setEventListeners();const _=new class extends e{constructor(t){super(t)}open(t,e){this._popup.querySelector(".popup__img").src=e,this._popup.querySelector(".popup__title_img").textContent=t,super.open()}}(".popup_card-img");_.setEventListeners(),r.addEventListener("click",(()=>{l.setInputValues(a.getUserInfo()),c.resetValidate(),l.open()}));const d=new s({popupSelector:".popup_card_add",submitForm:t=>{addCards.addItem(u(t))}});d.setEventListeners(),i.addEventListener("click",(()=>{h.resetValidate(),d.open()})),n.getAllCard().then((t=>{new class{constructor({items:t,renderer:e},s){this._initialArray=t,this._renderer=e,this._container=document.querySelector(s)}addItem(t){this._container.prepend(t)}renderItems(){this._initialArray.forEach((t=>{const e=this._renderer(t);this.addItem(e)}))}}({items:t,renderer:t=>u(t)},".cards").renderItems()})),n.getUserInfo().then((t=>{document.querySelector(".profile__avatar-img").src=t.avatar}));const c=new t(o,".popup_profile_edit"),h=new t(o,".popup_card_add");c.enableValidation(),h.enableValidation()})();